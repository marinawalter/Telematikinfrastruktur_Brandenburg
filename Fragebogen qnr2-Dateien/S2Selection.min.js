!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.S2Selection=t():e.S2Selection=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function n(e,t,i){var o,c=[],s=[],r={},h=!1,l=this;i&&7===e.length?this.registerItem=function(){}:(SoSciTools.QuestionWithItems.call(this,e,"select"),SoSciTools.registerQuestion&&SoSciTools.registerQuestion(e,this)),Object.defineProperty(this,"checked",{set:function(e){!function(e){if(!i)throw"Can only checkAll() of multiple choice questions.";for(var t=0,n=0;n<c.length;n++)p(c[n])?c[n].checked=!1:!o||t<o?(c[n].checked=e,t++):c[n].checked=!1}(!!e)}});for(var u=0;u<t.length;u++){var a,d=t[u],f=document.getElementById(d);f&&(c.push(f),(a=d.length>6&&"a"===d.substr(d.length-1,1)?new n.ItemRadio(d):new n.ItemCheckbox(d)).registerQuestion(this),this.registerItem(a),a.textInput&&(r[d]=a.textInput))}function p(e){for(var t=0;t<s.length;t++)if(s[t]===e)return!0;return!1}function g(){if(l.responseEvent){for(var e=0,t=0;t<c.length;t++)c[t].checked&&c[t].id in r&&e++;return l.responseEvent(l.responseComplete(),e,-9)}}if(c.length>0&&"checkbox"===c[0].tagName&&(h=!0),this.registerExclusive=function(e){var t=document.getElementById(e),n=[],i=[];if(t){for(var o=0;o<c.length;o++)c[o]!==t&&i.push(c[o]);for(s.push(t),SoSciTools.attachEvent(t,"click",(function(){if(t.checked)for(var e=0;e<i.length;e++)n[e]=i[e].checked,i[e].checked=!1,SoSciTools.dispatchEvent(i[e],"change");else for(e=0;e<i.length;e++)p(i[e])||(i[e].checked=n[e],SoSciTools.dispatchEvent(i[e],"change"))})),o=0;o<i.length;o++)SoSciTools.attachEvent(i[o],["click","change"],r)}function r(e){var n;e||(e=window.event),p(n=e.srcElement?e.srcElement:this)||n.checked&&(t.checked=!1,SoSciTools.dispatchEvent(t,"change"))}},this.registerMinChecked=function(e){},this.registerMaxChecked=function(e){o=e;var t=!1;function n(n){if(!t){t=!0;for(var i=0,o=0;o<c.length;o++)c[o].checked&&i++;if(i>e){var s=SoSciTools.getSender(n);s.checked=!1,SoSciTools.dispatchEvent(s,"change")}t=!1}}for(var i=0;i<c.length;i++)SoSciTools.attachEvent(c[i],["click","change"],n)},this.enableAutosubmit=function(e){this.responseAutosubmit(e)},this.responseComplete=function(){var e;h?(e=o)<1&&(e=1):e=1;for(var t=0,n=!1,i=0;i<c.length;i++)c[i].checked&&(t++,c[i].id in r&&""===r[c[i].id].value&&(n=!0));return t>=e&&!n},this.responseCSS){var S=document.getElementById(e+"_qst");this.responseCSS(S)}if(SoSciTools.attachEvent(c,"click",g),r)for(var m in r)r[m].addEventListener("keyup",g)}e.d(t,{default:()=>i}),n.LinkSelect2Text=function(e,t,n){var i,o,c,s=!1,r=!1,h=null,l=null,u=this,a=null;function d(e){e.checked||(e.checked=!0,SoSciTools.dispatchEvent(e,"click",{context:"S2Selection"}),e.checked=!0,SoSciTools.dispatchEvent(e,"change",{context:"S2Selection"}))}this.init=function(e,t){if(i="string"==typeof e?document.getElementById(e):e,"string"==typeof t?(o=document.getElementById(t),a=t):(o=t,a=t.getAttribute("id")),!i)throw"There is no selection input with ID "+e;if(!o)throw"There is no input with ID "+t;0===(c=document.getElementsByName(i.getAttribute("name"))).length&&(c=[i]),SoSciTools.attachEvent(o,["keyup","change"],this.onChangeInput),SoSciTools.attachEvent(c,["click","change"],this.onChangeSelect)},this.getInput=function(){if(a){var e=document.getElementById(a);e&&(o=e)}return o},this.inputIsEmpty=function(){return""===this.getInput().value.replace(/^\s+|\s+$/g,"")},this.inputSetEmpty=function(){this.getInput().value="";var e=new CustomEvent("s2change");this.getInput().dispatchEvent(e)},this.onChangeInput=function(e){if(u.inputIsEmpty()){if(s){(n=i).checked&&("checkbox"===n.getAttribute("type").toLowerCase()?(SoSciTools.dispatchEvent(n,"click",{context:"S2Selection"}),n.checked=!1):n.checked=!1,SoSciTools.dispatchEvent(n,"change",{context:"S2Selection"})),s=!1,h&&d(h);for(var t=0;t<c.length;t++)c[t].checked&&SoSciTools.dispatchEvent(c[t],"change")}}else if(!i.checked){for(h=null,r=!1,t=0;t<c.length;t++)if(c[t].checked){h=c[t];break}s=!0,d(i)}var n},this.onChangeSelect=function(e){var t=SoSciTools.getSender(e);if("click"!==e.type||t!==i||!e.detail||"S2Selection"!==e.detail.context){if(i.checked){if(u.inputIsEmpty()&&null!==l){u.getInput().value=l;var c=new CustomEvent("s2change");u.getInput().dispatchEvent(c)}l=null,r=!1}else r||n||(l=o.value,u.inputSetEmpty(),r=!0);e.detail&&"S2Selection"===e.detail.context||(s=!1,h=null)}},void 0!==t&&this.init(e,t)},n.LinkSelect2Dropdown=function(e,t,i){n.LinkSelect2Text.call(this,e,i),this.inputIsEmpty=function(){return"-9"===this.getInput().value||""===this.getInput().value},this.inputSetEmpty=function(){this.getInput().value="-9"},void 0!==t&&this.init(e,t)},n.linkOptionToInput=function(e,t,i){var o=document.getElementById(t);if(!o)throw"There is no input with ID "+t;if("INPUT"===o.nodeName)new n.LinkSelect2Text(e,t,i);else{if("SELECT"!==o.nodeName)throw"Unsupported input "+o.nodeName;new n.LinkSelect2Dropdown(e,t,i)}},n.Item=function(e,t,i){var o=!1,c=null,s=document.getElementById(t+"_container"),r=t.substr(5);"R"===r.substr(0,1)?o=!0:r=parseInt(r),SoSciTools.QuestionItem.call(this,r,i,s),Object.defineProperty(this,"residual",{get:function(){return o}}),Object.defineProperty(this,"textInput",{get:function(){return c}}),Object.defineProperty(this,"disabled",{get:function(){return i.disabled},set:function(e){return i.disabled=e}}),this.registerOpenEndedInput=function(e){c=e,new n.LinkSelect2Text(i.getAttribute("id"),c.getAttribute("id"))}},n.ItemRadio=function(e){if(!e.match(/^[a-z0][a-z0-9]\d{2}_[\dR]\d*a$/i))throw"Unexpected format for radio optionID: "+JSON.stringify(e);var t=e.substr(0,e.length-1),i=document.getElementById(e);n.Item.call(this,e,t,i);var o=document.getElementById(t);!o||"INPUT"!==o.nodeName&&"TEXTAREA"!==o.nodeName||this.registerOpenEndedInput(o)},n.ItemCheckbox=function(e){if(!e.match(/^[a-z0][a-z0-9]\d{2}_[\dR]\d*$/i))throw"Unexpected format for checkbox optionID: "+JSON.stringify(e);var t=e,i=document.getElementById(e);n.Item.call(this,e,t,i);var o=document.getElementById(t+"a");!o||"INPUT"!==o.nodeName&&"TEXTAREA"!==o.nodeName||this.registerOpenEndedInput(o)};const i=n;return t.default})()}));